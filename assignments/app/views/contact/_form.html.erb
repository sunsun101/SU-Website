<%= form_with(model: complain, url: contact_form_path) do |form| %>
  <% if @complain.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@complain.errors.count, "error") %> prohibited this member from being saved:</h2>
      <ul>
        <% @complain.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <% if current_user %>
    <%= form.hidden_field :id, value: current_user.email%>
  <% end %>
  <div class="login">
    <%= form.text_field :subject, class:"input", placeholder: "Subject" %>
    <%= form.select( :tag_id, ["Academic Affair", "Accomodation & Asset", "Campus & Environment", "Entertainment & Sport", "External Affair","Gender & Culture","Media  & Communication"],{}, {class:"input"})%>
  </div>
  <br>
  <div class = "row col-12">
    <div class="col-sm-8">
      <%= form.file_field :picture, class:"input", id: "gallery-photo-add", :multiple => true %>
      <a style="display:none;" id="removeImage" href="#">Remove</a>
    </div>
  </div>
  <div class="gallery"></div>
  <br>
  <div class="msg" >
    <%= form.text_area :detail, placeholder: "Leave a Message", class: "area"  %>
  </div>
  <%= form.submit 'Send message', class: 'btn formbtn' %>
<% end %>
<script>
  const div1 = document.getElementById("removeImage");
    $(function() {
        // Multiple images preview in browser
        var imagesPreview = function(input, placeToInsertImagePreview) {
            if (input.files) {
                var filesAmount = input.files.length;
  
                if (filesAmount > 0){
  
                    for (i = 0; i < filesAmount; i++) {
                    var reader = new FileReader();
                    var id = $(input.files[i]).attr('id');
                    reader.onload = function(event) {
                        $($.parseHTML('<img>')).attr('src', event.target.result).appendTo(placeToInsertImagePreview);
                    }
  
                    reader.readAsDataURL(input.files[i]);
                }
  
                }else{
                    console.log("imhere");
                    $(placeToInsertImagePreview).html('');
                }
            }
  
        };
  
        $('#gallery-photo-add').on('change', function() {
            imagesPreview(this, 'div.gallery');
            $("#removeImage").toggle(); // show remove link
        });
        $("#removeImage").click(function(e) {
          e.preventDefault(); // prevent default action of link
          this.files= []
          console.log(this.files);
          imagesPreview(this, 'div.gallery');
        //   $('#blah').attr('src', ""); //clear image src
          $("#gallery-photo-add").val(""); // clear image input value
          $("#removeImage").toggle(); // hide remove link.
          });
    });
</script>
