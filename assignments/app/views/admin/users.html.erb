<div class="container">
  <h1>Admin Dashboard</h1>
  <br>
  <h3>Users</h3>
  <div style="float:right; margin-bottom:10px;"><%= form_tag(admin_users_path, method: :get) do%>
      <%= text_field_tag(:search, params[:search])%>
      <%= submit_tag("Search", :class => "btn btn-warning")%>
    <% end %>
    <br>
    <button type="button" class="btn btn-primary" style= "float:right" data-mdb-toggle="modal" data-mdb-target="#exampleModal" >
      Advanced Search
    </button>
  </div>
  <br>
  <table class= "table table-striped table-bordered table-hover">
    <thead style = "background-color:#506477; color:white">
      <tr style="text-align:center">
        <th>Email</th>
        <th>Registered Date</th>
        <th>Status</th>
        <th>Edit</th>
      </tr>
    </thead>
    <tbody>
      <% if @users.each do |user| %>
        <tr style="text-align:center">
          <td><%= user.email %></td>
          <td><%= user.created_at.strftime("%d/%m/%Y") %></td>
          <% if user.status == 'A' %>
            <td style="color:green">Active</td>
          <% else %>
            <td style="color:red">Banned</td>
          <% end %>
          <td>
            <%= link_to 'Edit',  '#', 'data-mdb-target' => "#myModal_#{user.id}", 'data-mdb-toggle' => 'modal', :class=>"btn btn-primary"  %>
            <div class="modal fade" id='<%= "myModal_#{user.id}" %>' tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Email:  <%= user.email %> </h5>
                    <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close" ></button>
                  </div>
                  <div class="modal-body">
                    <%= render 'admin/form', user: user %>
                  </div>
                </div>
              </div>
            </div>
          </td>
        </tr>
      <% end.empty? %>
      <tr>
        <td colspan="4" style="text-align:center"> No Users Found</td>
      </tr>
    <% end %>
  </tbody>
</table>
<br>
<h5>User Registration Trend</h5>
<div id="curve_chart" style="width: 900px; height: 500px"></div>
<%# <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script> %>
<%= javascript_tag do -%>
  google.charts.load("current", { packages: ["corechart"] });
  google.charts.setOnLoadCallback(drawChart);
  function drawChart() {
  var data = JSON.parse('<%= @data.to_json.html_safe -%>');
  data = [['Year/Month', 'Count']].concat(data);
  data = google.visualization.arrayToDataTable(data);
  var options = {
  title: 'User Registration',
  curveType: 'function',
  legend: { position: 'bottom' }
  };
  var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));
  chart.draw(data, options);
  }
<% end %>
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Advanced Search</h5>
        <button
          type="button"
          class="btn-close"
          data-mdb-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body"><%= render 'admin/search_user'%></div>
    </div>
  </div>
</div>
</div>
